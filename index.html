<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tirage au sort de la map</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #2c2c2c;
            color: #f4a261;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .map-container, .history-container, .stats-container {
            margin: 20px;
            padding: 20px;
            background-color: #3a3a3a;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        .map {
            font-size: 24px;
            margin: 10px;
            padding: 10px;
            border-radius: 8px;
            background-color: #4a4a4a;
        }
        .selected-map {
            font-weight: bold;
            color: #e76f51;
            font-size: 28px;
        }
        .history-container, .stats-container {
            width: 300px;
            border: 2px solid #f4a261;
            max-height: 350px;
            display: flex;
            flex-direction: column;
        }
        .history-header, .stats-header {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            padding-bottom: 10px;
        }
        .history-list, .stats-list {
            flex-grow: 1;
            overflow-y: auto;
            background-color: #3a3a3a;
            padding: 10px;
            border-radius: 5px;
        }
        .history-item, .stats-item {
            background-color: #4a4a4a;
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
        }
        .container {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        button {
            background-color: #e76f51;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s;
        }
        button:hover {
            background-color: #f4a261;
        }
    </style>
</head>
<body>
    <h1>Tirage au sort de la map</h1>
    <div class="map-container">
        <div class="map" id="skeld">The Skeld: <span class="percentage">20.0%</span></div>
        <div class="map" id="polus">Polus: <span class="percentage">20.0%</span></div>
        <div class="map" id="mira">Mira HQ: <span class="percentage">20.0%</span></div>
        <div class="map" id="airship">The Airship: <span class="percentage">20.0%</span></div>
        <div class="map" id="fungle">Fungle: <span class="percentage">20.0%</span></div>
    </div>
    <button onclick="tirerAuSort()">Tirage au sort de la map</button>
    <h2 id="resultat"></h2>
    
    <div class="container">
        <div class="history-container">
            <div class="history-header">Historique des tirages</div>
            <div id="history-list" class="history-list"></div>
        </div>
        <div class="stats-container">
            <div class="stats-header">Pourcentage joué</div>
            <div id="stats-list" class="stats-list">
                <div class="stats-item" id="stats-skeld">The Skeld: 0.0% (0)</div>
                <div class="stats-item" id="stats-polus">Polus: 0.0% (0)</div>
                <div class="stats-item" id="stats-mira">Mira HQ: 0.0% (0)</div>
                <div class="stats-item" id="stats-airship">The Airship: 0.0% (0)</div>
                <div class="stats-item" id="stats-fungle">Fungle: 0.0% (0)</div>
            </div>
        </div>
    </div>

    <script>
        let maps = [
            { name: "The Skled", id: "skeld", percentage: 20, played: 0 },
            { name: "Polus", id: "polus", percentage: 20, played: 0 },
            { name: "Mira HQ", id: "mira", percentage: 20, played: 0 },
            { name: "The Airship", id: "airship", percentage: 20, played: 0 },
            { name: "Fungle", id: "fungle", percentage: 20, played: 0 }
        ];
        let totalPlays = 0;

        function tirerAuSort() {
            let rand = Math.random() * 100;
            let cumulative = 0;
            let selectedMap = null;

            for (let map of maps) {
                cumulative += map.percentage;
                if (rand < cumulative) {
                    selectedMap = map;
                    break;
                }
            }
            
            selectedMap.played++;
            totalPlays++;
            updateStats();
            
            let now = new Date().toLocaleTimeString();
            let historyList = document.getElementById("history-list");
            let newHistoryItem = document.createElement("div");
            newHistoryItem.className = "history-item";
            newHistoryItem.textContent = `${now} - ${selectedMap.name}`;
            historyList.insertBefore(newHistoryItem, historyList.firstChild);
            
            document.getElementById("resultat").innerHTML = `Map sélectionnée: <span class='selected-map'>${selectedMap.name}</span>`;
            
            let redistribution = selectedMap.percentage / 4;
            selectedMap.percentage = 0;

            for (let map of maps) {
                if (map !== selectedMap) {
                    map.percentage += redistribution;
                }
            }
            
            for (let map of maps) {
                document.querySelector(`#${map.id} .percentage`).textContent = `${map.percentage.toFixed(1)}%`;
            }
        }

        function updateStats() {
            for (let map of maps) {
                let percentagePlayed = totalPlays > 0 ? ((map.played / totalPlays) * 100).toFixed(1) : 0.0;
                document.getElementById(`stats-${map.id}`).textContent = `${map.name}: ${percentagePlayed}% (${map.played})`;
            }
        }
    </script>
</body>
</html>
